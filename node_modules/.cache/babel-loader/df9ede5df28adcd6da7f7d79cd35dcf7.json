{"ast":null,"code":"var _jsxFileName = \"/Users/TravelComputer/Desktop/node_sandbox/reactapp/node_modules/react-komponent/src/components/componentFunction.js\";\nimport React from 'react';\nimport { combined as combinedReducers } from '../reducers/index';\nimport { combineReducers } from 'redux';\nimport { createSelector } from 'reselect';\nimport { connect } from 'react-redux';\nimport FetchingPage from './fetchingOverlay';\nimport '../index.css';\nimport { createStore } from 'redux';\nimport createSagaMiddleware from 'redux-saga';\nimport { all, call, put, takeEvery, takeLatest, takeLeading } from 'redux-saga/effects';\nimport allReducers from '../reducers';\nimport { Provider } from 'react-redux';\nimport { BrowserRouter } from 'react-router-dom';\nimport { persistStore, persistReducer } from 'redux-persist';\nimport storage from 'redux-persist/lib/storage';\nimport { PersistGate } from 'redux-persist/es/integration/react';\nimport { applyMiddleware } from 'redux';\nimport thunkMiddleware from 'redux-thunk';\nconst persistConfig = {\n  key: 'primary',\n  storage\n};\nconst configuredReducers = persistReducer(persistConfig, allReducers);\nconst sagaMiddleware = createSagaMiddleware();\nexport const store = createStore(configuredReducers, applyMiddleware(thunkMiddleware, sagaMiddleware));\nconst persistor = persistStore(store);\nlet combined = combinedReducers;\n\nfunction lowerFirst(word) {\n  console.log('word!', word);\n  return word.charAt(0).toLowerCase() + word.slice(1);\n}\n\nfunction toHash(obj) {\n  if (!obj) return 0;\n  let string = JSON.stringify(obj);\n  var hash = 0;\n  let char;\n  let i;\n  if (string.length == 0) return hash;\n\n  for (i = 0; i < string.length; i++) {\n    char = string.charCodeAt(i);\n    hash = (hash << 5) - hash + char;\n    hash = hash & hash;\n  }\n\n  return hash;\n}\n\nconst classInherit = komp => {\n  let comp = Object.setPrototypeOf({}, komp);\n\n  while (comp = Object.getPrototypeOf(comp)) {\n    if (Object.getPrototypeOf(comp) === Component) break;\n\n    if (Object.getPrototypeOf(comp) === React.Component) {\n      Object.setPrototypeOf(comp, Component);\n      break;\n    }\n  }\n};\n\nconst objInherit = komp => {\n  let comp = Object.setPrototypeOf({}, komp);\n\n  while (comp = Object.getPrototypeOf(comp)) {\n    console.log(comp.constructor.name);\n    if (Object.getPrototypeOf(comp) && Object.getPrototypeOf(comp).constructor === Component) break;\n\n    if (Object.getPrototypeOf(comp) && Object.getPrototypeOf(comp).constructor === React.Component) {\n      Object.setPrototypeOf(comp, Component.prototype);\n      break;\n    }\n  }\n};\n\nlet previous = [];\n\nfunction Component(props) {\n  let newProto = {};\n  let thiss = this;\n  Object.setPrototypeOf(newProto, Object.getPrototypeOf(this));\n  Reflect.ownKeys(Component.prototype).forEach(prop => {\n    let desc = Object.getOwnPropertyDescriptor(Component.prototype, prop);\n\n    if ('get' in desc) {\n      let newDesc = { ...desc,\n        get: desc.get.bind(thiss)\n      };\n      Object.defineProperty(newProto, prop, newDesc);\n    } else if (prop !== 'constructor' && typeof Component.prototype[prop] === 'function') newProto[prop] = Component.prototype[prop].bind(this);\n  });\n  Object.setPrototypeOf(this, newProto);\n  let component = props.component;\n  this.originalRender = this.render;\n  this.originalSetState = this.setState.bind(this);\n\n  if (!props.passThrough && this.constructor !== Component) {\n    let Cons = this.constructor;\n    let Connected = Komponent(Cons, true);\n\n    thiss.render = function () {\n      let renderedComp = /*#__PURE__*/React.createElement(Cons, Object.assign({\n        passThrough: true\n      }, props, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 29\n        }\n      }));\n\n      let renderThis = () => !renderedComp._self || !renderedComp._self.state ? renderedComp : /*#__PURE__*/React.createElement(Connected, Object.assign({\n        passThrough: true\n      }, props, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 101\n        }\n      }));\n\n      let returnThis = renderThis();\n      return returnThis;\n      return /*#__PURE__*/React.createElement(FetchingPage, {\n        component: renderThis,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 17\n        }\n      });\n    };\n\n    Object.setPrototypeOf(thiss, React.Component.prototype);\n    return thiss;\n  }\n\n  if (component) {\n    if (!component.registerReducers) {\n      classInherit(component);\n      objInherit(component.prototype);\n    }\n\n    component = new component(props);\n    Reflect.ownKeys(component).forEach(key => {\n      if (key === 'state') thiss.state = { ...component.state\n      };else if ('key' === 'setState') {} else try {\n        thiss[key] = component[key];\n      } catch {}\n    });\n    Object.setPrototypeOf(thiss, Object.getPrototypeOf(component));\n  }\n\n  console.log(\"in the constructor!!!!!!!!!!!!!!\", thiss.constructor.name);\n  let reducers = combined;\n  const componentName = component ? component.constructor.name : thiss.constructor.name;\n  thiss.componentName = thiss.componentName || lowerFirst(componentName);\n\n  thiss.originalComponentWillUnmount = thiss.componentWillUnmount || function () {};\n\n  thiss.initialized = false;\n  thiss.originalComponentDidMount = thiss.componentDidMount;\n  const stateFromStorage = Component.stateFromStorage;\n\n  const getState = () => props.selectors || props.mapState || store.getState();\n\n  thiss.actions = thiss.actions || {\n    setState: (payload, comp = thiss.componentName) => {\n      const type = comp.toUpperCase() + '_STATE_CHANGE';\n      return {\n        type: type,\n        payload\n      };\n    },\n    fetchData: (endpoint, name = 'fetchedData', callback, comp = thiss.componentName) => {\n      return async dispatch => {\n        dispatch(thiss.actions.fetchDataStart(comp));\n        console.log('endpoint', endpoint);\n        let json;\n\n        if (window.__PRELOADED_STATE__[name]) {\n          json = window.__PRELOADED_STATE__[name];\n          console.error('we have preloaded state!');\n          throw new Error();\n        } else {\n          json = await fetch(endpoint);\n          json = await json.json();\n        }\n\n        console.log('JSON:', json);\n        setTimeout(() => {\n          let res = dispatch(thiss.actions.fetchDataComplete(json, callback, name));\n          if (typeof callback === 'function') callback(res);\n        }, 5000);\n      };\n    },\n    fetchDataStart: (comp = thiss.componentName, callback = null) => {\n      let name = comp;\n      return {\n        type: comp.toUpperCase() + '_FETCH_DATA_START',\n        callback,\n        name\n      };\n    },\n    fetchDataComplete: (data, callback = null, name = 'fetchedData', comp = thiss.componentName) => {\n      console.log('in the fetch complete');\n      return {\n        type: comp.toUpperCase() + '_FETCH_DATA_COMPLETE',\n        payload: {\n          [name]: data,\n          callback\n        }\n      };\n    }\n  };\n  if (!Component.customReducers) Component.reducers[thiss.componentName] = thiss.reducer;\n\n  if (!Component.statefulComponents[thiss.componentName]) {\n    Component.statefulComponents[thiss.componentName] = thiss;\n\n    if (thiss.sagas) {\n      sagaMiddleware.run(Component.rootSaga);\n    }\n  }\n\n  let fromLocal = stateFromStorage();\n  let fromStore = getState();\n  let untracked = {};\n  let replenish = {};\n  Object.keys(fromLocal).forEach(key => {\n    if (!fromStore[key]) replenish[key] = fromLocal[key];\n\n    if (!fromStore[key] && !Component.reducers[key]) {\n      console.log('got one', key, fromLocal[key]);\n\n      untracked[key] = (state = null, action) => {\n        switch (action.type) {\n          case key.toUpperCase() + '_STATE_CHANGE':\n            return action.payload;\n\n          default:\n            return state;\n        }\n      };\n    }\n  });\n\n  if (Object.keys(untracked).length > 1) {\n    console.log('untracked!', untracked);\n    combined = { ...combined,\n      ...untracked\n    };\n    store.replaceReducer(combineReducers({ ...combined,\n      ...Component.reducers\n    }));\n    console.log('store from untracked:', store.getState());\n  }\n\n  Object.keys(replenish).forEach(key => {\n    thiss.useDispatch(thiss.actions.setState(stateFromStorage()[key], key));\n  });\n\n  thiss.setState = function (...args) {\n    let cb = () => {};\n\n    if (arguments.length === 2 && typeof arguments[1] === 'function') {\n      cb = args.pop();\n    } // console.log('before',getState())\n\n\n    thiss.originalSetState(arguments[0], st => {\n      cb(st);\n      thiss.suppressSetState = false;\n      console.log('setting state from originalsetstate', arguments[0]);\n      thiss.useDispatch(thiss.actions.setState(arguments[0])); // console.log('New State from setState',getState())\n\n      console.log('New State from setState', thiss.state);\n    });\n  };\n\n  thiss.componentWillUnmount = function () {\n    thiss.originalComponentWillUnmount();\n    const subs = thiss.useSelector.subscriptions;\n    if (!subs) return;\n    const unsubs = subs.get(thiss) || [];\n    unsubs.forEach(unsub => unsub());\n  };\n\n  thiss.componentDidMount = (...args) => {\n    console.log('------------- component DID mount!!!! -------------');\n    console.log('getstat', thiss);\n    console.log('thiss component in Component Did Mount', thiss);\n    console.log('component', Object.create(Component));\n\n    if (!thiss.initialized && thiss.state && Object.keys(thiss.state).length > 1) {\n      const storeState = props.selectors || props.mapState || getState()[thiss.componentName] || {};\n      const fetchedState = Object.keys(storeState).length < 1 ? thiss.state : storeState;\n\n      if (JSON.stringify(thiss.state) !== JSON.stringify(storeState)) {\n        thiss.setState(fetchedState, () => console.log('things!!!!!!!!!!'));\n      }\n    }\n\n    thiss.initialized = true;\n    if (thiss.originalComponentDidMount) thiss.originalComponentDidMount(...args);\n  };\n\n  thiss.render = function () {\n    let Rendered = thiss.originalRender.bind(thiss);\n    return /*#__PURE__*/React.createElement(FetchingPage, {\n      component: Rendered,\n      fetching: thiss.state && thiss.state.fetching ? true : false,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 284,\n        columnNumber: 14\n      }\n    });\n  };\n\n  if (!reducers[thiss.componentName] && Component.reducers[thiss.componentName]) Component.registerReducers();\n}\n\nComponent.prototype.getState = function () {\n  const thiss = this;\n  return thiss.props.selectors || thiss.props.mapState || store.getState();\n};\n\nComponent.prototype.useState = function (initial) {\n  let nextKey = 0;\n\n  if (this.state) {\n    Object.keys(this.state).forEach(key => {\n      if (typeof key === 'number') nextKey = key + 1;\n    });\n  }\n\n  let stateMirror = {\n    nextKey: initial\n  };\n  setTheState(initial);\n\n  function setTheState(newState) {\n    let thisState = this.state ? { ...this.state\n    } : {};\n    stateMirror[nextKey] = newState;\n    this.setState(...thisState, ...stateMirror);\n  }\n\n  return [stateMirror[nextKey], setTheState];\n};\n\nComponent.prototype.useSelector = function (...cb) {\n  const thiss = this;\n  const theState = thiss.props.selectors || thiss.props.mapState || store.getState();\n  const select = cb[0];\n  let selector = createSelector(...cb, things => things);\n  return selector(theState);\n  const us = this.useSelector;\n  const theSelected = select(theState);\n  if (!us.subscriptions) us.subscriptions = new WeakMap();\n  if (us.subscriptions.has(select)) return theSelected;\n  if (theState === theSelected || theSelected === theState[this.componentName]) return theSelected; // return theState\n\n  const unsub = store.subscribe(state => {\n    let newStore = thiss.props.mapState || store.getState();\n    let newSelected = select(newStore); // console.log('NEWSTORE FROM SUBSCRIBE',newStore)\n\n    let oldState = newSelected;\n    if (us.subscriptions.has(select)) oldState = us.subscriptions.get(select); // console.log(\"NEW STATE from Subscribe\",newSelected); console.log(\"OLD STATE from Subscribe\",oldState)\n\n    if (toHash(newSelected) !== oldState) {\n      console.log('HolA!!!!!'); // Subscriber actions here == Update state!!\n\n      thiss.setState({ ...thiss.state\n      });\n      us.subscriptions.set(select, toHash(newSelected));\n    }\n  });\n  const unsubs = us.subscriptions.get(thiss) || [];\n  us.subscriptions.set(thiss, [...unsubs, unsub]);\n  us.subscriptions.set(select, toHash(theSelected));\n  return theSelected;\n};\n\nComponent.prototype.useDispatch = function (...args) {\n  const thiss = this.component || this;\n  const reactComponentMethods = ['componentDidMount', 'componentWillMount', 'componentWillUnmount', 'render', 'constructClassInstance'];\n  const st = thiss.getStackTrace();\n  const instance = st[0];\n  const prevInstance = args[1] || st[1];\n  let reactMethod;\n  st.some(s => {\n    return reactComponentMethods.some(cm => {\n      if (s.includes('.' + cm)) {\n        reactMethod = cm;\n        return true;\n      }\n    });\n  });\n  previous.forEach((prev, ind) => previous[ind] = { ...prev\n  });\n  const inLoop = thiss.inLoop();\n  console.log('in loop', inLoop);\n  console.log(instance);\n  const inPrevious = previous.some(prev => prev.arg === args[0].toString() && prev.instance === instance && prevInstance === prev.prevInstance && reactMethod === prev.reactMethod);\n  console.log('STATE', thiss.props);\n  console.log('THIS', thiss);\n\n  try {\n    console.log('STORE', store.getState());\n  } catch {}\n\n  if (inLoop || inPrevious) {\n    console.log('stuck in a loop - getting out ...');\n    throw new Error();\n    console.log(previous);\n    return;\n  }\n\n  previous.push({\n    arg: args[0].toString(),\n    instance,\n    prevInstance,\n    reactMethod\n  });\n  console.log(inLoop);\n  thiss.suppressSetState = false;\n\n  if (thiss.dispatches && thiss.dispatches.key === args[0]) {\n    console.log('already dispatching this -- bailing ...');\n    return;\n  }\n\n  thiss.wrapped = thiss.wrapped || [];\n\n  if (thiss.suppressDispatch === args[0]) {\n    console.log('suppressing dispatch ...');\n    thiss.suppressDispatch = false;\n    return;\n  }\n\n  let dispatch = thiss.props.dispatch || store.dispatch;\n  console.log(args[0]);\n\n  try {\n    dispatch(args[0]);\n  } catch (err) {\n    console.log(err);\n    console.log(this.getStackTrace());\n  }\n\n  thiss.dispatches = {};\n  thiss.suppressSetState = true; // this.dispatching.splice(this.dispatching.indexOf(arguments[0]))\n};\n\nComponent.prototype.fetchData = function (name, endpoint, callback) {\n  const thiss = this;\n  console.log('----------fetchData!!!--------------');\n  thiss.useDispatch(thiss.actions.fetchData(endpoint, name, callback));\n};\n\nComponent.prototype.selector = function (...selectorFuncs) {\n  const thiss = this;\n  let state;\n  let props = this.props;\n  if (typeof arguments[0] === 'object') state = selectorFuncs.shift();\n  if (typeof arguments[0] === 'object') props = selectorFuncs.shift();\n  selectorFuncs = selectorFuncs && selectorFuncs.length > 0 ? selectorFuncs : [items => items];\n\n  const defaultSelector = defState => defState[thiss.componentName];\n\n  let selector = createSelector(defaultSelector, ...selectorFuncs);\n  return state ? selector(state, props) : selector;\n};\n\nObject.defineProperty(Component.prototype, 'reducer', {\n  get: function () {\n    const thiss = this;\n    let dispatches;\n    let suppressSetState = thiss.suppressSetState;\n\n    const reducerFunction = (state = thiss.state, action) => {\n      thiss.reducing = true;\n\n      if (thiss.dispatches) {\n        thiss.dispatches.value = action;\n        dispatches = thiss.dispatches;\n      }\n\n      console.log('in the reducer !!!!!!!');\n      console.log('constructor: ', thiss.constructor.name);\n      console.log('ACTION TYPE: ', action.type);\n      if (action.type === thiss.componentName.toUpperCase() + '_STATE_CHANGE') return { ...state,\n        ...action.payload\n      };else if (action.type === thiss.componentName.toUpperCase() + '_FETCH_DATA_START') return { ...state,\n        fetching: true\n      };else if (action.type === thiss.componentName.toUpperCase() + '_FETCH_DATA_COMPLETE') {\n        console.log('here we are!');\n        delete action.payload.callback;\n        const newState = { ...state,\n          fetching: false,\n          ...action.payload\n        };\n        console.log('setting state from FETCH_DATA_COMPLETE', newState);\n        return newState;\n      } else if (thiss.customReducer) return thiss.customReducer(state, action);\n      return state || Component.stateFromStorage(thiss.componentName) || null;\n    };\n\n    return (state = thiss.state, action) => {\n      if (thiss.dispatching) {\n        console.log('dispatching thing', thiss.dispatching);\n        console.log('dispatches things', thiss.dispatches.key);\n        console.log('--------------------------------');\n      }\n\n      console.log('REDUCER FUNCTION START!!!!');\n      console.log('original state');\n      const newState = reducerFunction(state, action);\n      console.log(\"REDUCER FUNCTION COMPLETE!!!!!\", newState);\n      console.log(\"EQUAL\", thiss.state === newState);\n      console.log('state', thiss.state, 'new', newState);\n      suppressSetState = newState === thiss.state || action.type.includes('@@') ? true : false;\n\n      if (dispatches) {\n        console.log('supress dispatch:');\n        thiss.suppressDispatch = dispatches.key;\n      }\n\n      if (!suppressSetState) {\n        console.log('NO SUPPRESS SETSTATE -- ORIGINAL SET STATE');\n        console.log('before', thiss.state);\n        console.log('newState', newState);\n        thiss.originalSetState.call(thiss, newState, () => {\n          console.log('after', thiss.state);\n        });\n      } else {\n        console.log('New = Old', newState === thiss.state);\n        console.log('action type', action.type);\n        console.log('SETTING STATE SUPPRESSED!!!!!!');\n      } // thiss.originalSetState(newState,() => { throw new Error })\n\n\n      return newState;\n    };\n  },\n  set: function (newReducer) {\n    this.customReducer = newReducer;\n  }\n});\nComponent.prototype.saga = {};\nComponent.prototype.saga.takeLatest = takeLatest;\nComponent.prototype.saga.takeEvery = takeEvery;\nComponent.prototype.saga.takeLeading = takeLeading;\nComponent.prototype.saga.call = call;\nComponent.prototype.saga.put = put;\n\nComponent.prototype.getStackTrace = function () {\n  const thiss = this;\n  let stackTrace;\n  let stack;\n  stack = new Error().stack;\n  stackTrace = stack.split(\"\\n\");\n  stackTrace.forEach((st, ind) => {\n    let returnVal = st.split('@')[0];\n    if (returnVal.includes(' (')) returnVal = returnVal.split(' (')[0];\n    if (returnVal.includes('    at ')) returnVal = returnVal.split('    at ')[1];\n    stackTrace[ind] = returnVal;\n  });\n  stackTrace.shift();\n  stackTrace.pop();\n  if (stackTrace[0].includes('getStackTrace')) stackTrace.shift();\n  return stackTrace.filter(ti => ti !== \"\");\n};\n\nComponent.prototype.inLoop = function () {\n  const thiss = this;\n  console.log('thisssssssssss', thiss);\n  const st = thiss.getStackTrace();\n  return st.filter((s, i) => i !== 0).includes(st[0]);\n};\n\nComponent.stateFromStorage = function (component) {\n  let storageState = localStorage.getItem('persist:root');\n\n  try {\n    storageState = storageState ? JSON.parse(storageState) : null;\n  } catch {\n    return {};\n  }\n\n  if (!storageState) return {};\n  let returnState = {};\n  Object.keys(storageState).forEach(item => {\n    try {\n      returnState[item] = JSON.parse(storageState[item]);\n    } catch {\n      returnState[item] = {};\n    }\n  });\n  if (component) return returnState[component];\n  return returnState;\n};\n\nComponent.statefulComponents = {};\nComponent.reducers = {};\nObject.defineProperty(Component, 'reducer', {\n  get: function () {\n    const thiss = this;\n    let key = lowerFirst(thiss.name);\n    return (state = null, action) => {\n      switch (action.type) {\n        case key.toUpperCase() + '_STATE_CHANGE':\n          return action.payload;\n\n        default:\n          return state;\n      }\n    };\n  }\n});\nObject.defineProperty(Component, 'mapStateToProps', {\n  get: function () {\n    let mapStates = [];\n    let comp;\n    Object.keys(Component.statefulComponents).forEach(key => {\n      comp = Component.statefulComponents[key];\n      if (comp.mapStateToProps) mapStates = comp.mapStateToProps.concat(mapStates);\n    });\n    if (mapStates.length > 0) return mapStates;\n  }\n});\nObject.defineProperty(Component, 'rootSaga', {\n  get: function () {\n    const sagas = [];\n    let comp;\n    console.log('hey!!!', Component.statefulComponents);\n    Object.keys(Component.statefulComponents).forEach(key => {\n      comp = Component.statefulComponents[key];\n      if (comp.sagas) comp.sagas().forEach(sag => sagas.push(call(sag)));\n    });\n    if (sagas.length > 0) return function* rootSaga() {\n      yield all(sagas);\n    };\n  }\n});\n\nComponent.addReducers = function (red) {\n  let comb = { ...combined,\n    ...red\n  };\n  store.replaceReducer(combineReducers({ ...comb\n  }));\n};\n\nComponent.refreshReducers = function () {\n  store.replaceReducer(combineReducers({ ...combined,\n    ...Component.reducers\n  }));\n};\n\nComponent.registerReducers = function (red) {\n  if (red) {\n    Component.reducers = red;\n    Component.customReducers = true;\n  } else {\n    Component.customReducers = false;\n  }\n\n  try {\n    Object.keys(Component.reducers).some(redu => {\n      if (!store.getState()[redu]) Component.refreshReducers();\n    });\n  } catch {}\n};\n\nObject.setPrototypeOf(Component.prototype, React.Component.prototype);\nObject.setPrototypeOf(Component, React.Component);\n\nfunction Komponent(Com, bypassInherit = false) {\n  const thiss = Com;\n\n  if (!bypassInherit) {\n    classInherit(Com);\n    objInherit(Com.prototype);\n  }\n\n  const msp = (state, prps) => {\n    const ms = {\n      mapState: {},\n      selectors: {}\n    };\n    Object.keys(state).forEach(st => {\n      ms.mapState[st] = state[st];\n      ms.selectors[st] = createSelector(sta => sta[st], s => s)(state);\n    });\n\n    if (thiss.mapStateToProps) {\n      Reflect.ownKeys(thiss.mapStateToProps).forEach(key => {\n        ms.mapState[key] = createSelector(thiss.mapStateToProps[key], items => items)(state, prps);\n      });\n    }\n\n    return ms;\n  };\n\n  const mdp = thiss.mapDispatchToProps || null;\n  let Connected = mdp ? connect(msp, mdp)(Com) : connect(msp)(Com);\n  Object.defineProperty(Connected, 'name', {\n    value: Com.name,\n    writable: false\n  });\n  return Connected;\n}\n\nconst RootComponent = props => {\n  return /*#__PURE__*/React.createElement(React.StrictMode, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 684,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(BrowserRouter, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 685,\n      columnNumber: 10\n    }\n  }, /*#__PURE__*/React.createElement(Provider, {\n    store: store,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 686,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(PersistGate, {\n    persistor: persistor,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 687,\n      columnNumber: 13\n    }\n  }, props.children))));\n};\n\nexport { Component, RootComponent };","map":{"version":3,"sources":["/Users/TravelComputer/Desktop/node_sandbox/reactapp/node_modules/react-komponent/src/components/componentFunction.js"],"names":["React","combined","combinedReducers","combineReducers","createSelector","connect","FetchingPage","createStore","createSagaMiddleware","all","call","put","takeEvery","takeLatest","takeLeading","allReducers","Provider","BrowserRouter","persistStore","persistReducer","storage","PersistGate","applyMiddleware","thunkMiddleware","persistConfig","key","configuredReducers","sagaMiddleware","store","persistor","lowerFirst","word","console","log","charAt","toLowerCase","slice","toHash","obj","string","JSON","stringify","hash","char","i","length","charCodeAt","classInherit","komp","comp","Object","setPrototypeOf","getPrototypeOf","Component","objInherit","constructor","name","prototype","previous","props","newProto","thiss","Reflect","ownKeys","forEach","prop","desc","getOwnPropertyDescriptor","newDesc","get","bind","defineProperty","component","originalRender","render","originalSetState","setState","passThrough","Cons","Connected","Komponent","renderedComp","renderThis","_self","state","returnThis","registerReducers","reducers","componentName","originalComponentWillUnmount","componentWillUnmount","initialized","originalComponentDidMount","componentDidMount","stateFromStorage","getState","selectors","mapState","actions","payload","type","toUpperCase","fetchData","endpoint","callback","dispatch","fetchDataStart","json","window","__PRELOADED_STATE__","error","Error","fetch","setTimeout","res","fetchDataComplete","data","customReducers","reducer","statefulComponents","sagas","run","rootSaga","fromLocal","fromStore","untracked","replenish","keys","action","replaceReducer","useDispatch","args","cb","arguments","pop","st","suppressSetState","subs","useSelector","subscriptions","unsubs","unsub","create","storeState","fetchedState","Rendered","fetching","useState","initial","nextKey","stateMirror","setTheState","newState","thisState","theState","select","selector","things","us","theSelected","WeakMap","has","subscribe","newStore","newSelected","oldState","set","reactComponentMethods","getStackTrace","instance","prevInstance","reactMethod","some","s","cm","includes","prev","ind","inLoop","inPrevious","arg","toString","push","dispatches","wrapped","suppressDispatch","err","selectorFuncs","shift","items","defaultSelector","defState","reducerFunction","reducing","value","customReducer","dispatching","newReducer","saga","stackTrace","stack","split","returnVal","filter","ti","storageState","localStorage","getItem","parse","returnState","item","mapStates","mapStateToProps","concat","sag","addReducers","red","comb","refreshReducers","redu","Com","bypassInherit","msp","prps","ms","sta","mdp","mapDispatchToProps","writable","RootComponent","children"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { combined as combinedReducers } from '../reducers/index'\nimport { combineReducers } from 'redux'\nimport { createSelector } from 'reselect'\nimport { connect } from 'react-redux'\nimport FetchingPage from './fetchingOverlay'\n\nimport '../index.css';\nimport { createStore } from 'redux'\nimport createSagaMiddleware from 'redux-saga'\nimport { all, call, put, takeEvery, takeLatest, takeLeading } from 'redux-saga/effects';\n\nimport allReducers from '../reducers'\nimport { Provider } from 'react-redux'\nimport { BrowserRouter } from 'react-router-dom'\nimport { persistStore, persistReducer } from 'redux-persist';\nimport storage from 'redux-persist/lib/storage';\nimport { PersistGate } from 'redux-persist/es/integration/react';\nimport { applyMiddleware } from 'redux'\nimport thunkMiddleware from 'redux-thunk'\n\nconst persistConfig = {\n   key: 'primary',\n   storage\n};\n\nconst configuredReducers = persistReducer(persistConfig, allReducers);\nconst sagaMiddleware = createSagaMiddleware()\nexport const store = createStore(configuredReducers,applyMiddleware(thunkMiddleware,sagaMiddleware))\nconst persistor = persistStore(store)\n\nlet combined = combinedReducers\n\nfunction lowerFirst(word) {\n   console.log('word!',word)\n   return word.charAt(0).toLowerCase() + word.slice(1);\n}\n\nfunction toHash(obj) {      \n   if (!obj) return 0\n   let string = JSON.stringify(obj)\n   var hash = 0; let char; let i\n     \n   if (string.length == 0) return hash; \n     \n   for (i = 0; i < string.length; i++) { \n       char = string.charCodeAt(i); \n       hash = ((hash << 5) - hash) + char; \n       hash = hash & hash; \n   } \n   return hash; \n} \n\nconst classInherit = (komp) => {\n   let comp = Object.setPrototypeOf({},komp)\n   while (comp = Object.getPrototypeOf(comp)) {\n      if (Object.getPrototypeOf(comp) === Component)\n         break\n      if (Object.getPrototypeOf(comp) === React.Component) {\n         Object.setPrototypeOf(comp, Component)\n         break\n      }\n   }\n}\n\nconst objInherit = (komp) => {\n   let comp = Object.setPrototypeOf({},komp)\n   while (comp = Object.getPrototypeOf(comp)) {\n      console.log(comp.constructor.name)\n      if (Object.getPrototypeOf(comp) && Object.getPrototypeOf(comp).constructor === Component)\n         break\n      if (Object.getPrototypeOf(comp) && Object.getPrototypeOf(comp).constructor === React.Component) {\n         Object.setPrototypeOf(comp, Component.prototype)\n         break\n      }\n   }\n}\n\nlet previous = []\n\n\nfunction Component(props) {\n\n   let newProto = {}\n   let thiss = this\n   Object.setPrototypeOf(newProto,Object.getPrototypeOf(this))\n\n   Reflect.ownKeys(Component.prototype).forEach(prop => {\n\n      let desc = Object.getOwnPropertyDescriptor(Component.prototype,prop)\n      if ('get' in desc) {\n         let newDesc = { ...desc,get:desc.get.bind(thiss)}\n         Object.defineProperty(newProto,prop,newDesc)\n      } else if (prop !== 'constructor' && typeof Component.prototype[prop] === 'function')\n         newProto[prop] = Component.prototype[prop].bind(this)\n\n   })\n\n   Object.setPrototypeOf(this,newProto)\n\n   let component = props.component\n   this.originalRender = this.render\n   this.originalSetState = this.setState.bind(this)\n\n   if (!props.passThrough && this.constructor !== Component) {\n\n      let Cons = this.constructor\n      let Connected = Komponent(Cons,true)\n\n      thiss.render = function() { \n         \n         let renderedComp = <Cons passThrough={true} {...props}></Cons>\n         let renderThis = () => (!renderedComp._self || !renderedComp._self.state) ? renderedComp : <Connected passThrough={true} {...props}></Connected>\n         let returnThis = renderThis()\n         return returnThis\n         return <FetchingPage component={renderThis}></FetchingPage>\n      }\n\n      Object.setPrototypeOf(thiss,React.Component.prototype)\n      return thiss\n      \n   }\n\n\n\n   \n   if (component) {\n      if (!component.registerReducers) {\n         classInherit(component)\n         objInherit(component.prototype)\n      }\n      \n      component = new component(props)\n\n      Reflect.ownKeys(component).forEach(key => {\n         if (key === 'state')\n            thiss.state = { ...component.state}\n         else if ('key' === 'setState') {}\n         else try { thiss[key] = component[key] } catch {}\n      })\n      Object.setPrototypeOf(thiss,Object.getPrototypeOf(component))\n   }\n   \n   console.log(\"in the constructor!!!!!!!!!!!!!!\",thiss.constructor.name)\n   let reducers = combined\n   const componentName = component ? component.constructor.name : thiss.constructor.name\n   thiss.componentName = thiss.componentName || lowerFirst(componentName)\n\n   thiss.originalComponentWillUnmount = thiss.componentWillUnmount || function() {}\n   thiss.initialized = false\n   thiss.originalComponentDidMount = thiss.componentDidMount \n\n   const stateFromStorage = Component.stateFromStorage\n   const getState = () => props.selectors || props.mapState || store.getState() \n\n   thiss.actions = thiss.actions || { \n      setState: (payload,comp=thiss.componentName) => {\n         const type = comp.toUpperCase()+'_STATE_CHANGE'\n         return {\n            type: type,\n            payload\n         }\n      },\n      fetchData: (endpoint,name='fetchedData',callback,comp=thiss.componentName) => {\n         return async (dispatch) => {\n            dispatch(thiss.actions.fetchDataStart(comp))\n            console.log('endpoint',endpoint);\n            let json\n            if (window.__PRELOADED_STATE__[name]) {\n               json = window.__PRELOADED_STATE__[name]\n               console.error('we have preloaded state!')\n               throw new Error\n            }  else { \n               json = await fetch(endpoint)\n               json = await json.json()\n            }\n            console.log('JSON:',json)\n            setTimeout(\n               () => {\n                  let res = dispatch(thiss.actions.fetchDataComplete(json,callback,name))\n                  if (typeof callback === 'function') callback(res)\n               },5000\n            )\n         }\n      },\n      fetchDataStart: (comp=thiss.componentName,callback=null) => {  \n         let name = comp\n         return { type: comp.toUpperCase()+'_FETCH_DATA_START', callback, name }\n      },\n      fetchDataComplete: (data, callback=null, name='fetchedData', comp=thiss.componentName) => {\n         console.log('in the fetch complete')\n         return { type: comp.toUpperCase()+'_FETCH_DATA_COMPLETE', payload: { [name]: data, callback } }\n      }\n   }\n\n   if (!Component.customReducers)\n      Component.reducers[thiss.componentName] = thiss.reducer\n\n   if (!Component.statefulComponents[thiss.componentName]) {\n      Component.statefulComponents[thiss.componentName] = thiss\n      if (thiss.sagas) {\n         sagaMiddleware.run(Component.rootSaga)\n      }\n   }  \n\n   let fromLocal = stateFromStorage(); let fromStore = getState()\n\n   let untracked = {}; let replenish = {}\n   Object.keys(fromLocal).forEach(key => {\n      if (!fromStore[key]) replenish[key] = fromLocal[key]\n      if (!fromStore[key] && !Component.reducers[key]) {\n         console.log('got one',key,fromLocal[key])\n         untracked[key] = (state=null, action) => {\n            switch(action.type) {\n               case key.toUpperCase()+'_STATE_CHANGE':\n                  return action.payload\n               default:\n                  return state\n            }\n         }\n      }\n   })\n   \n   if (Object.keys(untracked).length > 1) {\n      console.log('untracked!', untracked)\n      combined = { ...combined, ...untracked }\n      store.replaceReducer(combineReducers({ ...combined, ...Component.reducers }))\n      console.log('store from untracked:',store.getState())\n   }\n\n   Object.keys(replenish).forEach(key => {\n      thiss.useDispatch(thiss.actions.setState(stateFromStorage()[key],key))\n   })\n   \n   thiss.setState = function(...args) {\n      let cb = () => {}\n      if (arguments.length === 2 && typeof arguments[1] === 'function') {\n         cb = args.pop()\n      }\n      // console.log('before',getState())\n      thiss.originalSetState(arguments[0],(st) => {\n         cb(st)\n         thiss.suppressSetState = false\n         console.log('setting state from originalsetstate',arguments[0])\n         thiss.useDispatch(thiss.actions.setState(arguments[0]))\n         // console.log('New State from setState',getState())\n         console.log('New State from setState',thiss.state)\n      })\n   }\n\n   thiss.componentWillUnmount = function() {\n      thiss.originalComponentWillUnmount()            \n      const subs = thiss.useSelector.subscriptions\n      if (!subs) return\n      const unsubs = subs.get(thiss) || []\n      unsubs.forEach(unsub => unsub())\n   }\n\n   thiss.componentDidMount = (...args) => {\n      console.log('------------- component DID mount!!!! -------------')\n      console.log('getstat',thiss)\n\n      console.log('thiss component in Component Did Mount',thiss)\n      console.log('component',Object.create(Component))\n      if (!thiss.initialized && thiss.state && Object.keys(thiss.state).length > 1) {\n         const storeState = props.selectors || props.mapState || getState()[thiss.componentName] || {}\n         const fetchedState = (Object.keys(storeState).length < 1) ? thiss.state : storeState\n         if (JSON.stringify(thiss.state) !== JSON.stringify(storeState)) {\n            thiss.setState(fetchedState,() => console.log('things!!!!!!!!!!'))\n         }\n      }\n      thiss.initialized = true\n\n      if (thiss.originalComponentDidMount)\n         thiss.originalComponentDidMount(...args)\n   }\n\n   thiss.render = function() {\n\n\n      \n\n      let Rendered = thiss.originalRender.bind(thiss)\n      return <FetchingPage component={Rendered} fetching={(thiss.state && thiss.state.fetching) ? true : false}></FetchingPage>\n\n\n\n      \n   }\n\n   if (!reducers[thiss.componentName] && Component.reducers[thiss.componentName])\n      Component.registerReducers()\n\n}\nComponent.prototype.getState = function() { \n   const thiss = this\n   return thiss.props.selectors || thiss.props.mapState || store.getState()\n}\nComponent.prototype.useState = function(initial) {\n   let nextKey = 0\n   if (this.state) {\n      Object.keys(this.state).forEach(key => {\n         if (typeof key === 'number')\n            nextKey = key+1\n      })\n   }\n   let stateMirror = { nextKey:initial }\n   setTheState(initial)\n\n   function setTheState(newState) {\n      let thisState = this.state ? {...this.state} : {}\n      stateMirror[nextKey] = newState\n      this.setState(...thisState, ...stateMirror)\n   }\n   \n   return [stateMirror[nextKey],setTheState]\n}\nComponent.prototype.useSelector = function(...cb) { \n   const thiss = this\n   const theState = thiss.props.selectors || thiss.props.mapState || store.getState() \n   const select = cb[0]\n\n   let selector = createSelector(...cb,(things) => things)\n   return selector(theState)\n\n   const us = this.useSelector\n   const theSelected = select(theState)\n\n   if (!us.subscriptions)\n      us.subscriptions = new WeakMap\n\n   if (us.subscriptions.has(select))\n      return theSelected\n\n   if (theState === theSelected || theSelected === theState[this.componentName])\n      return theSelected\n\n   // return theState\n\n   const unsub = store.subscribe(state => {\n\n      let newStore = thiss.props.mapState || store.getState()\n      let newSelected = select(newStore)\n\n      // console.log('NEWSTORE FROM SUBSCRIBE',newStore)\n\n      let oldState = newSelected\n\n      if (us.subscriptions.has(select))\n         oldState = us.subscriptions.get(select)\n\n      // console.log(\"NEW STATE from Subscribe\",newSelected); console.log(\"OLD STATE from Subscribe\",oldState)\n      if (toHash(newSelected) !== oldState) {\n         console.log('HolA!!!!!')\n         // Subscriber actions here == Update state!!\n         thiss.setState({ ...thiss.state })\n         us.subscriptions.set(select,toHash(newSelected))\n      }\n   })\n   const unsubs = us.subscriptions.get(thiss) || []\n   us.subscriptions.set(thiss,[...unsubs,unsub])\n   us.subscriptions.set(select,toHash(theSelected))\n   return theSelected\n}\n\nComponent.prototype.useDispatch = function(...args) {\n\n   const thiss = this.component || this\n   const reactComponentMethods = [\n      'componentDidMount',\n      'componentWillMount',\n      'componentWillUnmount',\n      'render',\n      'constructClassInstance'\n   ]\n\n   const st = thiss.getStackTrace()\n   const instance = st[0]\n   const prevInstance = args[1] || st[1]\n   let reactMethod\n   st.some(s => {\n      return reactComponentMethods.some(cm => {\n         if (s.includes('.'+cm)) {\n            reactMethod = cm\n            return true\n         }\n      })\n   })\n\n   previous.forEach((prev,ind) => previous[ind] = {...prev})\n   const inLoop = thiss.inLoop()\n   console.log('in loop',inLoop)\n   console.log(instance)\n\n   const inPrevious = previous.some(prev => (prev.arg === args[0].toString()) && (prev.instance === instance) && (prevInstance === prev.prevInstance) && (reactMethod === prev.reactMethod))\n   console.log('STATE',thiss.props)\n   console.log('THIS',thiss)\n   try { console.log('STORE',store.getState()) } catch {}\n   if (inLoop || inPrevious) {\n      console.log('stuck in a loop - getting out ...')\n      throw new Error\n      console.log(previous)\n      return\n   }\n\n   previous.push({ arg:args[0].toString(), instance, prevInstance, reactMethod })\n   console.log(inLoop);\n\n   thiss.suppressSetState = false\n\n   if (thiss.dispatches && thiss.dispatches.key === args[0]) {\n      console.log('already dispatching this -- bailing ...')\n      return\n   }\n\n   thiss.wrapped = thiss.wrapped || []\n\n   if (thiss.suppressDispatch === args[0]) {\n      console.log('suppressing dispatch ...')\n      thiss.suppressDispatch = false\n      return\n   }\n\n   let dispatch = thiss.props.dispatch || store.dispatch\n   \n   console.log(args[0])\n   try { dispatch(args[0]) } catch(err) { \n\n      console.log(err); \n      console.log(this.getStackTrace())\n   }\n   \n   thiss.dispatches = {}\n   thiss.suppressSetState = true\n\n   // this.dispatching.splice(this.dispatching.indexOf(arguments[0]))\n}\n\nComponent.prototype.fetchData = function(name,endpoint,callback) {\n   const thiss = this\n   console.log('----------fetchData!!!--------------')\n   thiss.useDispatch(thiss.actions.fetchData(endpoint,name,callback))\n}\n\nComponent.prototype.selector = function(...selectorFuncs) {\n   const thiss = this; let state; let props=this.props\n   if (typeof arguments[0] === 'object') \n      state = selectorFuncs.shift()\n   if (typeof arguments[0] === 'object')\n      props = selectorFuncs.shift()\n   \n   selectorFuncs = (selectorFuncs && selectorFuncs.length > 0) ? selectorFuncs : [(items) => items]\n   const defaultSelector = (defState) => defState[thiss.componentName]\n\n   let selector = createSelector(\n      defaultSelector,\n      ...selectorFuncs\n   )\n   return state ? selector(state,props) : selector\n}\n\nObject.defineProperty(Component.prototype,'reducer',{ \n   get: function() {\n      const thiss = this\n      let dispatches\n      let suppressSetState = thiss.suppressSetState\n      const reducerFunction = (state=thiss.state,action) => { \n\n         thiss.reducing = true\n         if (thiss.dispatches) {\n            thiss.dispatches.value = action\n            dispatches = thiss.dispatches\n         }\n         console.log('in the reducer !!!!!!!')\n         console.log('constructor: ',thiss.constructor.name)\n         console.log('ACTION TYPE: ',action.type)\n\n         if (action.type === thiss.componentName.toUpperCase()+'_STATE_CHANGE') \n            return { ...state, ...action.payload }\n         else if (action.type === thiss.componentName.toUpperCase()+'_FETCH_DATA_START')\n            return { ...state, fetching:true }\n         else if (action.type === thiss.componentName.toUpperCase()+'_FETCH_DATA_COMPLETE') {\n            console.log('here we are!')\n            delete action.payload.callback\n            const newState = { ...state, fetching:false, ...action.payload } \n            console.log('setting state from FETCH_DATA_COMPLETE',newState)\n            return newState\n         }\n         else if (thiss.customReducer)\n            return thiss.customReducer(state,action)\n         return state || Component.stateFromStorage(thiss.componentName) || null\n      } \n\n      return (state=thiss.state,action) => {\n         if (thiss.dispatching) {\n            console.log('dispatching thing',thiss.dispatching)\n            console.log('dispatches things',thiss.dispatches.key)\n            console.log('--------------------------------')\n         }\n         console.log('REDUCER FUNCTION START!!!!')\n         console.log('original state')\n         const newState = reducerFunction(state,action)\n         console.log(\"REDUCER FUNCTION COMPLETE!!!!!\",newState)\n         console.log(\"EQUAL\", thiss.state === newState)\n         console.log('state',thiss.state, 'new',newState)\n\n         suppressSetState = ((newState === thiss.state) || (action.type.includes('@@'))) ? true : false\n\n         if (dispatches) {\n            console.log('supress dispatch:')\n            thiss.suppressDispatch = dispatches.key\n         }\n         if (!suppressSetState) {\n            console.log('NO SUPPRESS SETSTATE -- ORIGINAL SET STATE')\n            console.log('before',thiss.state)\n            console.log('newState',newState)\n            thiss.originalSetState.call(thiss,newState, () => { console.log('after',thiss.state); })\n         } else {\n            console.log('New = Old', newState === thiss.state);\n            console.log('action type', action.type)\n            console.log('SETTING STATE SUPPRESSED!!!!!!')\n         }\n         // thiss.originalSetState(newState,() => { throw new Error })\n         return newState\n      }     \n   },\n   set: function(newReducer) {\n      this.customReducer = newReducer\n   }\n})\n\nComponent.prototype.saga = {}\nComponent.prototype.saga.takeLatest = takeLatest\nComponent.prototype.saga.takeEvery = takeEvery\nComponent.prototype.saga.takeLeading = takeLeading\nComponent.prototype.saga.call = call\nComponent.prototype.saga.put = put\n\nComponent.prototype.getStackTrace = function() {\n   const thiss = this\n   let stackTrace; let stack\n   stack = new Error().stack\n   stackTrace = stack.split(\"\\n\")\n   stackTrace.forEach((st,ind) => {\n      let returnVal = st.split('@')[0]\n      if (returnVal.includes(' (')) returnVal = returnVal.split(' (')[0]\n      if (returnVal.includes('    at ')) returnVal = returnVal.split('    at ')[1] \n      stackTrace[ind] = returnVal\n   })\n   stackTrace.shift(); stackTrace.pop()\n   if (stackTrace[0].includes('getStackTrace')) stackTrace.shift()\n   return stackTrace.filter(ti => ti !== \"\")\n}\n\nComponent.prototype.inLoop = function() { \n   const thiss = this\n   console.log('thisssssssssss',thiss)\n   const st = thiss.getStackTrace()\n   return st.filter((s,i) => i !== 0).includes(st[0]) \n}\n\nComponent.stateFromStorage = function(component) {\n   let storageState = localStorage.getItem('persist:root')\n   try {\n      storageState = storageState ? JSON.parse(storageState) : null\n   } catch { return {} }\n\n   if (!storageState) return {}\n   \n   let returnState = {}\n   Object.keys(storageState).forEach(item => { \n      try {\n            returnState[item] = JSON.parse(storageState[item])\n      } catch { returnState[item] = {} }\n   })  \n   if (component) return returnState[component]\n   return returnState        \n}\nComponent.statefulComponents = {}\nComponent.reducers = {}\nObject.defineProperty(Component,'reducer',{ \n   get: function() {\n      const thiss = this\n      let key = lowerFirst(thiss.name)\n      return (state=null, action) => {\n         switch(action.type) {\n            case key.toUpperCase()+'_STATE_CHANGE':\n               return action.payload\n            default:\n               return state\n         }\n      }\n   }\n})\n\nObject.defineProperty(Component,'mapStateToProps',{ \n   get: function() {\n      let mapStates = []\n      let comp\n      Object.keys(Component.statefulComponents).forEach(key => {\n         comp = Component.statefulComponents[key]\n         if (comp.mapStateToProps)\n            mapStates = comp.mapStateToProps.concat(mapStates)\n      })\n      if (mapStates.length > 0)\n         return mapStates\n   }\n})\n\nObject.defineProperty(Component,'rootSaga',{ \n   get: function() {\n      const sagas = []\n      let comp\n      console.log('hey!!!',Component.statefulComponents)\n      Object.keys(Component.statefulComponents).forEach(key => {\n         comp = Component.statefulComponents[key]\n         if (comp.sagas)\n            comp.sagas().forEach(sag => sagas.push(call(sag)))\n      })\n      if (sagas.length > 0)\n         return function* rootSaga() {\n            yield all(sagas)\n         }\n   }\n})\nComponent.addReducers = function(red) {\n   let comb = { ...combined, ...red }\n   store.replaceReducer(combineReducers({ ...comb }))\n}\nComponent.refreshReducers = function() {\n   store.replaceReducer(combineReducers({ ...combined, ...Component.reducers }))\n}\nComponent.registerReducers = function(red) {\n   if (red) {\n      Component.reducers = red\n      Component.customReducers = true\n   } else {\n      Component.customReducers = false\n   }\n   try {\n      Object.keys(Component.reducers).some(redu => {\n         if (!store.getState()[redu])\n            Component.refreshReducers()\n      })\n   } catch {}\n}\nObject.setPrototypeOf(Component.prototype,React.Component.prototype)\nObject.setPrototypeOf(Component,React.Component)\n\nfunction Komponent(Com,bypassInherit=false) {\n   const thiss = Com\n   \n   if (!bypassInherit) {\n      classInherit(Com)\n      objInherit(Com.prototype)\n   }\n\n   const msp = (state,prps) => {\n      const ms = { \n         mapState: {},\n         selectors: {}\n      }\n      Object.keys(state).forEach(st => { \n         ms.mapState[st] = state[st]\n         ms.selectors[st] = createSelector(sta => sta[st],(s) => s)(state)\n      })\n      if (thiss.mapStateToProps) {\n         Reflect.ownKeys(thiss.mapStateToProps).forEach(key => { \n            ms.mapState[key] = createSelector(thiss.mapStateToProps[key],(items) => items)(state,prps)\n         })\n      }    \n      return ms\n   }\n   const mdp = thiss.mapDispatchToProps || null\n   let Connected = mdp ? connect(msp,mdp)(Com) : connect(msp)(Com)\n   Object.defineProperty(Connected,'name',{ value: Com.name, writable:false})\n\n   return Connected\n\n}\n\nconst RootComponent = (props) => {\n   return (\n      <React.StrictMode>\n         <BrowserRouter>\n            <Provider store={store}>\n            <PersistGate persistor={persistor}>\n               {props.children}\n            </PersistGate>\n            </Provider>\n         </BrowserRouter>\n      </React.StrictMode>\n   );\n }\n\n export { Component, RootComponent }"]},"metadata":{},"sourceType":"module"}